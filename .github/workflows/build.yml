name: Build Debug APK

on:
  # 'main' ব্রাঞ্চে পুশ করলে এই Workflow চলবে
  push:
    branches:
      - main
  # ম্যানুअली চালানোর জন্যও অপশন
  workflow_dispatch:

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      # ধাপ ১: রিপোজিটরির কোড আনা
      - name: Checkout repository
        uses: actions/checkout@v4

      # ধাপ ২: JDK 17 সেটআপ করা
      - name: Set up JDK 17
        uses: actions/setup-java@v4
        with:
          java-version: '17'
          distribution: 'temurin'
          cache: gradle

      # ধাপ ৩: Gradle Wrapper-কে এক্সিকিউট করার অনুমতি দেওয়া
      - name: Grant execute permission for gradlew
        run: chmod +x gradlew

      # ধাপ ৪: স্যাম্পল অ্যাপের ডিবাগ APK বিল্ড করা
      - name: Build Debug APK for Sample App
        run: ./gradlew :sample:assembleDebug

      # ধাপ ৫: বিল্ড হওয়া APK ফাইলটিকে Artifact হিসেবে আপলোড করা
      - name: Upload Debug APK
        uses: actions/upload-artifact@v4
        with:
          name: HyperStreamKit-Sample-Debug-APK
          path: sample/build/outputs/apk/debug/sample-debug.apk